## 性能优化在瓶颈上做

> 学过计算机体系结构的人都应该知道，性能优化只应该在瓶颈上做，因为做在非瓶颈上就是浪费资源。同理技术或产品的优化都应该是做在瓶颈上的，所以 senior 的人应该熟悉整套系统并且能够有效找到当前的瓶颈。

------



## 定义问题、分析问题、解决问题

> 这需要培养一种思维方式：
>
> 1. 定义问题。到底我要解决的是什么问题？什么问题我不需要解决？如果你选择了解决这个问题，哪些事情属于这个问题的范畴哪些事情不属于？大家是否都认同解决这个问题是有价值的？选择了对的问题，才能做出来有意义的答案。
> 2. 分析问题。解决这个问题的关键路径是什么？有哪些子问题可以暂时不解决，哪些子问题必须优先解决？什么信息还处于缺失状态？如何能够获取这些信息？获得到这些信息后，可能会出现哪些新的子问题需要考虑？
> 3. 解决问题。这里只需要执行力……
>
> 总的来说，这就是一个人肉 DP（动态规划）问题。你不一定知道到达重点的最佳路线，你连计算路线的信息都不全，你必须有一个精明的算法指导你下一步怎么走，走一步获取一点新的信息然后重新计算下一步怎么走。
>
> > 举个例子，你接受了一个老应用要优化它的性能。这时候你的问题定义是什么？你就是要让它跑得更快，同时维持代码可读性、可靠性在相似水平。你不要尝试去重构它，更加不要想着去重写它，因为这些都不是你问题定义的一部分。
> >
> > 然后你需要分析这个问题如何解决。你肯定要学习一下写出这个应用的语言，但你需要精通吗？很可能需要要。你需要找一个性能分析工具，但你真的需要非常精通性能分析吗？如果这个应用从来没有人优化过，估计很容易找到能够优化一下性能就大幅度提升的地方，你也不需要特别在行。当然这样说不是 100% 靠谱，所以这是一个有待挖掘的信息，你需要真的做一些初步分析后才能更准确地评估花多大的力气能够获得多大的回报。问题继续拆分的话，那就是你如何找到性能分析工具，遇到问题有谁能帮你解决，等等。
>
> > 在美国大家还很看重定义问题的能力。世界上有万千问题可以解决，为什么你选择解决这个问题而不是那个问题？

------



## Technical / Direction / People 

为什么要把一个人的行为划分为 technical、direction 和 people 三个方面来看？因为这样比较容易解释清楚大公司的级别系统是如何运作的，以及为什么不可能拿到更高的级别。

**technical**，这就是你能解决多难的问题，以及解决得有多好。给你很难的问题你解决不了，自然 technical 不行。给你容易的问题你解决了，但代码质量低、架构混乱、维护成本高，这同样是 technical 不够高的表现。总的来说，technical 侧重于解决问题，也就是中国应试教育擅长培育的项目。

与之对应并且相反的是 **direction**，也就是定义问题，一个中国应试教育从来没有教过你的项目。这个世界上有千千万万的问题，为什么你要解决这个问题而不是解决那个问题？如果你选择了解决这个问题，哪些事情属于这个问题的范畴哪些事情不属于？这些都是 direction 关注的问题。

> 打个比方来说，你的目标还是在 120 分钟的考试拿 100 分，但试卷如同 1000 分普通试卷的容量，要 120,000 分钟才能全部做完，总分 100,000 分。没错，只要你做完 0.1% 就 100 分了，但到底做哪 0.1% 呢？这才是个问题。这份试卷有 90% 是你不会做的，剩下有 9% 是你正确率不高的，只有 1% 是你很确信能做对的。对于你擅长的 1%，你只要做其中 10% 你就能搞掂那 0.1% 的要求，但这还是大海捞针。
>
> 然而对于一家大公司来说，这个大海捞针的过程十分重要。选择了对的问题，才能做出来有意义的答案。选择了错误的问题，浪费大量公司资源最终什么都做不出来，或者被同行打败，那 technical 再好也没用。

当然有时时候你找到了正确的 direction 别人也不支持你。你的上级不相信你，不愿意给你资源，甚至直接不批准你做你认为正确的 direction，强迫你继续做他认为正确的 direction。你的下属不相信你，不跟随你的 direction。又或者是你的下属没办法很好理解你的 direction，以为自己做的事情对你目标有贡献，结果是什么帮助都没有。还有可能你的下属 technical 的能力就不够，帮不上忙还降低整个项目的质量。这时候就涉及到 people 的问题了。

所谓的 **people**，最终还是要服务于你的 technical 和 direction 的，或者至少是服务于整个公司的 technical 和 direction 的。你要让 direction 跟你不一致的人信服你，或者至少是能够跟他们做交易：我帮你这件事情，你帮我那件事情。你要让 technical 不够好帮不上忙的人成长起来，让他们变得能够帮忙。

> 但其实在公司里面，尤其是大公司里面，不依赖于其他人的成功是几乎没有可能的。一方面，你要选择正确的 direction 就需要收集很多信息，例如公司未来计划是什么，重点会在哪方面投入，近期最大的障碍会是什么。这些信息都在不同的人手上，你需要很多的沟通才能收集回来。另一方面，一个人的 technical 再怎么厉害也是有上限的，你要你的输出程指数级增长，唯一的办法就是借助别人的 technical 能力帮你解决部分你的问题，否则你达到自己的上限了就上不去了。

> 对于科技公司来说，级别增长对于输出的要求都是指数级增长的，线性增长是没办法帮你晋升的，只能拿更多的奖金。作为 senior，输出至少要相当于几个 junior，而且最好能做一些几个 junior 各自为政做不到的事情。
>
> 从 senior 到 principal 或 staff 的过程也是类似的，你的输出至少是一个顶几个，而且最好能做到几个低一级的人各自为政做不了的事情。这时候 direction 和 people 就会显得越来越重要，因为你要说服别人各自带领自己的团队单干效果不如多个团队分工合作完成你的目标好，那首先你要有个好目标，其次你要能说服人。
>
> 如果一个 principal 要有能力帮助几个 senior，让他们做得比各自单干要更好，那作为 principal 的要解决什么问题呢？

其实很多中国人晋升的瓶颈真的不在 technical 上面，但 technical 在优化下去对全局的贡献不大。你需要意识到自己当前的瓶颈在哪里，是什么阻碍了你的输出指数级上升，然后专注于解决这些障碍。还是回到上面所说的，不要等着别人告诉你你的问题在哪里，你要在千千万万的问题里面找出来你身上的什么问题如果解决了你能更快地成长。



------



## 动态规划(dynamic programming)

------



## Mind Palace

------



## 资源、流程、优先级

 > 《How Will You Measure Your Life》这本书中的一个道理。企业有没有能力做成某一件事情，依赖于以下三项因素：资源、流程、优先级。
 >
 > > 把这对应到个人身上：「懂 iOS 开发」是资源。「有学习方法」是流程，流程可以用来产生资源，例如「学会 iOS 开发」。「现在有很多需要解决的问题，经分析确定这个问题才是现阶段最值得需要解决的」，这是优先级。如果优先级选择要解决的问题需要用到一个 app，而这个 app 又不能买到现成的，那你可以看看自己是否有「懂 iOS 开发」这项资源，然后自己写一个。如果你没有这项资源的话，你可以看看自己是否有「学会 iOS 开发」这项流程，然后开始学习。
 > >
 > > 其实只有优先级能确定方向解决现实问题。只有资源没有用，你懂 iOS 开发但这不一定能解决真正需要解决的问题，你可能用这项资源解决了很多其实不需要解决的问题。只有流程也不行，你可能学会了很多不同的技术，但最终你不知道什么问题才是需要解决的，于是解决了很多不需要解决的问题。只有确定了什么问题需要解决，然后下一步才去考虑什么流程和资源可以用来解决这个问题。
 > >
 > > 同理，只有你确定了你的目标是什么，然后才能讨论掌握什么技能有用。
 >
 > ------



## OKR

思考一下这几个问题：

1. 公司的成长需要什么？

2. 团队的成长需要什么？

3. 你个人的成长需要什么？

这是你制定 Objective 的主线。如果你不是高管，第一个问题不由你来决定，尽管你可以去提出你的想法。同理，如果你不负责一个团队，第二个问题也不由你来决定。

有了 Objective 然后才能制定 Key Result，这是不能本末倒置的。不能想好要做成某个 Key Result，再去设计一个包含该 Key Result 的 Objective 并且补充几个没有意义的并列 Key Result。这样做实际上就是以制定 KPI 的思路来做 OKR。

好的管理应该是能够让员工感觉 OKR 是自己制定的，同时又引导了员工服从公司 OKR。否则工程师一上来就说「我的 Objective 是重构」，然后你怎么办？你需要能够正确地提问，「重构对公司 Objective 的价值在哪里？」、「除了重构还有其它哪些途径能够实现公司 Objective？」、「对比所有的替代方案，重构是不是下一阶段最优的选择？」

在一张白纸上随便写几项 OKR 有什么难度，真正的难度在于整个过程中你要知道公司需要什么，员工的强项是什么，兴趣是什么，什么有待改进。把这些结合起来，你才知道你需要做什么，而 OKR 只是相当于在地上画条车道让你不要走歪。



## 关于 Facebook 的级别

[Quora reference 1](https://link.zhihu.com/?target=https%3A//www.quora.com/What-is-the-expectation-out-of-each-software-engineering-level-at-Facebook) [Quora reference 2](https://link.zhihu.com/?target=https%3A//www.quora.com/What-does-it-take-to-be-a-Senior-Software-Engineer-at-Facebook/) [Quora reference 3](https://link.zhihu.com/?target=https%3A//www.quora.com/How-do-Facebook-engineering-levels-map-to-Googles)

基本上 Quora 的第一个答案就说得很清楚了。

一般中国人都很容易理解不同级别有不一样的 technical 要求，我就说说从 scope 和 direction 方面如何划分级别吧：

E3 的 scope 是一个星期的工作量。这意味着，如果有一个星期工作量的任务，你可以放心把它交给 E3 来做，他能够独立完成 coding 和通过 code review，最后把代码 check-in 等代码自动 release 到 production。E3 在 direction 方面是没有任何要求的，也就是说 E3 不需要告诉别人做什么，E3 在独立完成自己的 scope 后可以问别人接下来还有什么可以做。简单来说 E3 可以不输出 direction 只输入 direction。

> 例如一个 E3 刚刚从 Bootcamp 毕业进组，tech lead 可能对他说「这里有几个任务让你热身和熟悉我们的代码。你先把它们做完吧，有什么问题来找我」。E3 只要在合理的时间内把这几个任务做完且达到合理的质量就行了。接着他可以问 tech lead 还有什么可以做的，tech lead 再给别的任务他。

E4 的 scope 是一个月的工作量。这意味着 E4 不能好像 E3 那样不停地问下一个星期干什么，E4 自己应该知道下一个星期有什么可以干的。这也就意味着 E4 所需要的 direction 输入比 E3 少。就算没有 tech lead 告诉 E4 接下来要干什么，E4 也可以自己找事情来做。尽管找来的事情不一定是接下来最值得做的事情，但 E4 可以独立工作下去。因此只要 tech lead 把接下来要做的事情按优先级排好，E4 就不太需要更多的 direction 输入。

> 很多组都会有半年计划，一份半年计划里面包含了若干项目。例如说如果整个组的目标是增加用户激活数，那就会有若干项目尝试做不同的事情来增加这个指标。这些项目的潜在价值不一样、失败风险不一样、技术难度不一样、所需时间不一样……tech lead 综合这些因素，再加上 E4 本人的兴趣和技术特长，跟 E4 一起选定一个项目让他做，他能按时完成保证质量，那就可以了。E4 做完一个项目可以再跟 tech lead 协商下一个项目做什么。

E5 的 scope 是三个月到半年，因此 E5 有时候就是负责整个组半年计划的 tech lead。E5 的 direction 输入和输出基本上要平衡，也就是说 E5 还可以从级别更高的人那里获取一些「什么值得做」的信息，但同时要有能力向 E3/E4 提供「什么值得做」的信息。这其实很容易理解，因为 E5 自己负责的目标是需要三个月到半年才能做完的，他当然应该有能力确定自己每周每月干什么，也就应该有能力跟 E3/E4 沟通每周每月干什么。

当然并不是每一个 E5 都要成为 tech lead 的，不同人擅长做不一样的事情。同样是增加用户激活数，有些 E5 在做好半年的计划后自己一个人把所有事情做了，有些 E5 自己只做最难的部分同时协调几个 E3/E4 做简单的部分，让他们有学习和成长的机会。单纯讨论半年计划的执行结果，这两种做法是等效的。但如果考虑公司的全局利益，那当然顺便帮助其它人成长更好一些。

从 E3 到 E5 的变化可以看出级别上升的趋势是什么，就是 scope 越来越大，direction 输入越来越低输出越来越高。但总的来说 E3 到 E5 的道路只有一条，但 E5 往后的道路就开始分支，有不同的成长方向能达到更大的 scope。

E5 是第一个可以尝试体验转做经理的级别，对应的是 M0。之后 E6 到 E9 分别对应 M1、M2、D1、D2。尽管大公司都会说，我们技术和管理两条线是平行的，如果你不喜欢做管理的话可以一直做技术。但实际上管理是一个很大的概念，做不做经理的区别是做不做人事管理，然而项目管理是无论哪条线都需要的。级别越高，scope 越大，项目的复杂度就越高。这个复杂度不一定是技术能够解决的，也有可能是跟人相关的。

从 E6 开始，direction 的输出就要大于输入。没有人能够告诉你具体做什么项目能够成为 E6，因为如果一个项目告诉你去做就能做成功的话，那就不是一个 E6 的项目。E6 要能自己找到 scope 足够大的项目，而且这种项目往往存在很大的风险，不保证做了就一定能成功。要做到这样的 scope，不同人的做法可以很不一样，不可能再归纳出一种典型的 E6 做事方式。之后级别越高，同一级别内实现目标的方式越因人而异。

总的来说，级别的增长意味着 scope 的几何级数增长。当 scope 增长到一定程度，就不能再从别人那里获得 direction，而必须自己找到正确的 direction。



# Self-fulfilling prophecy

[wikipedia](https://en.wikipedia.org/wiki/Self-fulfilling_prophecy)